{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/draft-post-support-on-gatsby-blog/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://geekscreed.com"}},"post":{"fields":{"slug":"/draft-post-support-on-gatsby-blog/"},"frontmatter":{"title":"How to add Draft posts Support to Gatsby blog","authors":[{"id":"sasivarnan","name":"Sasivarnan R","bio":"Software Engineer. Tech Enthusiast. Loves coding ðŸ’» and music ðŸŽ¼.","website":"https://geekscreed.com","twitter":"iamsasivarnan","linkedin":"sasivarnan","profile_image":"https://avatars0.githubusercontent.com/u/5305600?v=4"}],"tags":[{"id":"gatsby","name":"Gatsby","slug":"gatsby"},{"id":"web-dev","name":"Web Development","slug":"web-dev"},{"id":"graphql","name":"GraphQL","slug":"graphql"}],"published_at":"16 Dec, 2018","feature_image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#c8c8c8","images":{"fallback":{"src":"/static/adb9176d1cd50c2a15ff91bc7ee099d2/65b10/drafts.jpg","srcSet":"/static/adb9176d1cd50c2a15ff91bc7ee099d2/e1101/drafts.jpg 180w,\n/static/adb9176d1cd50c2a15ff91bc7ee099d2/28a30/drafts.jpg 360w,\n/static/adb9176d1cd50c2a15ff91bc7ee099d2/65b10/drafts.jpg 720w,\n/static/adb9176d1cd50c2a15ff91bc7ee099d2/09a10/drafts.jpg 1440w","sizes":"(min-width: 720px) 720px, 100vw"},"sources":[{"srcSet":"/static/adb9176d1cd50c2a15ff91bc7ee099d2/66d05/drafts.webp 180w,\n/static/adb9176d1cd50c2a15ff91bc7ee099d2/5e54a/drafts.webp 360w,\n/static/adb9176d1cd50c2a15ff91bc7ee099d2/2b5db/drafts.webp 720w,\n/static/adb9176d1cd50c2a15ff91bc7ee099d2/4a723/drafts.webp 1440w","type":"image/webp","sizes":"(min-width: 720px) 720px, 100vw"}]},"width":720,"height":466}}}},"excerpt":"Ever encountered a situation where you need to skip some unfinished, unpolished posts while deploying your Gatsby blog? Gatsby is awesomeâ€¦","html":"<p>Ever encountered a situation where you need to skip some unfinished, unpolished posts while deploying your Gatsby blog?</p>\n<p><a href=\"/tag/gatsby\">Gatsby</a> is awesome ðŸ’Ÿ.</p>\n<p>Using modern web technologies, it takes care of a lot of optimizations out of the box.</p>\n<p>Unlike traditional CMS like <code>WordPress</code> which gives a lot of features out of the box, in Gatsby, we need to hand pick the features that we need for our blog and build it by ourselves. It's not bad. It's cool ðŸ˜Ž.</p>\n<blockquote>\n<p>With great power comes great responsibility.</p>\n</blockquote>\n<p>As we have the complete control over adding features to Gatsby, there are lots of ways to achieve a single feature.</p>\n<p>In this article, I am gonna walk us through a simpler way to add support for draft posts to your Gatsby blog.</p>\n<p>Let's enhance our blog powered by <code>markdown</code> files to skip all the posts which are marked as <code>draft</code> in it's <code>frontmatter</code> while building the site.</p>\n<p>First of all, pick your first published post and add <code>draft: false</code>. This will make gatsby to create the <code>graphQL</code> schema for <code>markdownRemark</code> with <code>draft</code> field in it, which is needed in while querying.</p>\n<blockquote>\n<p><strong>Note:</strong> Gatsby infers the schema during the initial load of the development server. Hence you need to restart the gatsby development server in order to add <code>drafts</code> property to the gatsby schema.</p>\n</blockquote>\n<p>Add the following filter in every page where you are querying <code>allMarkdownRemark</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"lang-diff\"><code class=\"lang-diff\"><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>   ...\n<span class=\"token prefix unchanged\"> </span>   allMarkdownRemark(\n</span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>      sort: { fields: [frontmatter___date], order: DESC }\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>      sort: { fields: [frontmatter___date], order: DESC },\n<span class=\"token prefix inserted\">+</span>      filter: {frontmatter: {draft: {ne: true}}}\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>   ) {\n<span class=\"token prefix unchanged\"> </span>   ...</span></code></pre></div>\n<p>Next, add the following change in the graphql query of <code>createPages</code> method in <code>gatsby-node.js</code>. It will create the <code>draft</code> posts during <code>development</code> phase but skips during the <code>production</code> phase.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"lang-diff\"><code class=\"lang-diff\">...\nresolve(\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> graphql(\n<span class=\"token prefix unchanged\"> </span>   `{\n</span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>      allMarkdownRemark(sort: {fields: [frontmatter___date], order: DESC}, limit: 1000) {\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>      allMarkdownRemark(\n<span class=\"token prefix inserted\">+</span>       sort: {fields: [frontmatter___date], order: DESC},\n<span class=\"token prefix inserted\">+</span>         ${\n<span class=\"token prefix inserted\">+</span>           process.env.NODE_ENV === 'production' ?\n<span class=\"token prefix inserted\">+</span>           'filter: {frontmatter: {draft: {ne: true}}}' :\n<span class=\"token prefix inserted\">+</span>           ''\n<span class=\"token prefix inserted\">+</span>         }\n<span class=\"token prefix inserted\">+</span>         limit: 1000\n<span class=\"token prefix inserted\">+</span>      ) {\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>      edges {\n<span class=\"token prefix unchanged\"> </span>       ...</span></code></pre></div>\n<p>Now in <code>gatsby-config.js</code> file, make the following change to skip draft posts while generating the RSS feed.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"lang-diff\"><code class=\"lang-diff\">...\n<span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>  `gatsby-plugin-feed`,\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  {\n<span class=\"token prefix inserted\">+</span>     resolve: `gatsby-plugin-feed`,\n<span class=\"token prefix inserted\">+</span>     options: {\n<span class=\"token prefix inserted\">+</span>       feeds: [\n<span class=\"token prefix inserted\">+</span>         {\n<span class=\"token prefix inserted\">+</span>           query: `\n<span class=\"token prefix inserted\">+</span>           {\n<span class=\"token prefix inserted\">+</span>             allMarkdownRemark(\n<span class=\"token prefix inserted\">+</span>               limit: 1000,\n<span class=\"token prefix inserted\">+</span>               sort: {order: DESC, fields: [frontmatter___date]},\n<span class=\"token prefix inserted\">+</span>               filter: {frontmatter: {draft: {ne: true}}}\n<span class=\"token prefix inserted\">+</span>             ) {\n<span class=\"token prefix inserted\">+</span>               edges {\n<span class=\"token prefix inserted\">+</span>                 node {\n<span class=\"token prefix inserted\">+</span>                   excerpt\n<span class=\"token prefix inserted\">+</span>                   html\n<span class=\"token prefix inserted\">+</span>                   fields {\n<span class=\"token prefix inserted\">+</span>                     slug\n<span class=\"token prefix inserted\">+</span>                   }\n<span class=\"token prefix inserted\">+</span>                   frontmatter {\n<span class=\"token prefix inserted\">+</span>                     title\n<span class=\"token prefix inserted\">+</span>                     date\n<span class=\"token prefix inserted\">+</span>                   }\n<span class=\"token prefix inserted\">+</span>                 }\n<span class=\"token prefix inserted\">+</span>               }\n<span class=\"token prefix inserted\">+</span>             }\n<span class=\"token prefix inserted\">+</span>           }\n<span class=\"token prefix inserted\">+</span>           `,\n<span class=\"token prefix inserted\">+</span>           output: `rss.xml`\n<span class=\"token prefix inserted\">+</span>         },\n<span class=\"token prefix inserted\">+</span>       ]\n<span class=\"token prefix inserted\">+</span>     }\n<span class=\"token prefix inserted\">+</span> },\n</span>...</code></pre></div>\n<p>That's it. Now your blog has support for draft posts. Any post which is marked as <code>draft: true</code> in its front matter will be skipped during the build time and available during the development time.</p>\n<p>I haven't covered every case. But this is applicable to most of the cases.</p>\n<p>Once check the list of plugins you use in your <code>gatsby-config.js</code> file. You might be using some other plugins like <a href=\"https://www.gatsbyjs.org/packages/gatsby-plugin-feed-generator/\">gatsby-plugin-feed-generator</a>. You would need to configure it's graphql query accordingly.</p>\n<p>Hope I have helped you in adding drafts feature to your Gatsby blog with a minimal effort.</p>\n<p>Did this post help you to achieve it or found it complicated?</p>\n<p>Feel free to share your thoughts in the comments section.</p>"},"relatedPosts":{"totalCount":3,"edges":[{"node":{"timeToRead":3,"excerpt":"JavaScript has come a long way since its introduction in 1995. The dynamics of the language have completely changed since the adaptation ofâ€¦","fields":{"slug":"/dynamic-import-named-export/"},"frontmatter":{"title":"Dynamic Import named exports in JavaScript","published_at":"17 Feb, 2021","featured":null,"feature_image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#282828","images":{"fallback":{"src":"/static/feeaa63df36c1ca1ec60612b85404dde/3f4ea/port.jpg","srcSet":"/static/feeaa63df36c1ca1ec60612b85404dde/3f4ea/port.jpg 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[{"srcSet":"/static/feeaa63df36c1ca1ec60612b85404dde/5f7b9/port.webp 600w","type":"image/webp","sizes":"(min-width: 600px) 600px, 100vw"}]},"width":600,"height":400}}},"authors":[{"id":"sasivarnan","name":"Sasivarnan R","profile_image":"https://avatars0.githubusercontent.com/u/5305600?v=4"}],"tags":[{"id":"javascript","name":"JavaScript"},{"id":"webpack","name":"Webpack"},{"id":"web-dev","name":"Web Development"}]}}},{"node":{"timeToRead":2,"excerpt":"We are seeing an increase in the popularity of JAMStack. Gatsby is one of the popular JAMStack frameworks. There are a lot of tools andâ€¦","fields":{"slug":"/deploy-gatsby-site-to-github-pages-using-github-actions/"},"frontmatter":{"title":"Deploy Gatsby Site to GitHub Pages using GitHub Actions","published_at":"03 Dec, 2019","featured":null,"feature_image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#7898a8","images":{"fallback":{"src":"/static/7121a6d9018b45a47f522869e919e4cf/2daae/ship-it.jpg","srcSet":"/static/7121a6d9018b45a47f522869e919e4cf/2daae/ship-it.jpg 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[{"srcSet":"/static/7121a6d9018b45a47f522869e919e4cf/714c0/ship-it.webp 600w","type":"image/webp","sizes":"(min-width: 600px) 600px, 100vw"}]},"width":600,"height":374}}},"authors":[{"id":"sasivarnan","name":"Sasivarnan R","profile_image":"https://avatars0.githubusercontent.com/u/5305600?v=4"}],"tags":[{"id":"gatsby","name":"Gatsby"},{"id":"web-dev","name":"Web Development"},{"id":"github","name":"GitHub"}]}}},{"node":{"timeToRead":5,"excerpt":"Hello folks. In this article, I am gonna share why we should stop building custom webpack config and instead use create-react-app toâ€¦","fields":{"slug":"/use-create-react-app-to-scaffold-next-react-app/"},"frontmatter":{"title":"Why you should use create-react-app to Scaffold your Next React App?","published_at":"12 Dec, 2018","featured":null,"feature_image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/5dd2d2fd5d249486989b97a6ceab8c5a/3f4ea/react-code-macbook.jpg","srcSet":"/static/5dd2d2fd5d249486989b97a6ceab8c5a/3f4ea/react-code-macbook.jpg 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[{"srcSet":"/static/5dd2d2fd5d249486989b97a6ceab8c5a/5f7b9/react-code-macbook.webp 600w","type":"image/webp","sizes":"(min-width: 600px) 600px, 100vw"}]},"width":600,"height":400}}},"authors":[{"id":"sasivarnan","name":"Sasivarnan R","profile_image":"https://avatars0.githubusercontent.com/u/5305600?v=4"}],"tags":[{"id":"react","name":"React JS"},{"id":"web-dev","name":"Web Development"},{"id":"webpack","name":"Webpack"}]}}}]}},"pageContext":{"slug":"/draft-post-support-on-gatsby-blog/","tags":["gatsby","web-dev","graphql"]}},"staticQueryHashes":["2136327730","2367946931","3544567509"]}